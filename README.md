# MawPLA: prediction of protein-ligand binding affinity using wavelet neural network and based on interpretable bimodal network
Ya Li, Xingyu Liao, Haoze Chai, Junwei Du, Xin Gao, Member, IEEE, and Bin Yu, Member, IEEE


##Introduction
This code repository implements a PyTorch implementation of the MawPLA framework, a wavelet transform-based bimodal deep learning model designed for protein-ligand binding affinity (PLA) prediction tasks. The model combines residue-level protein sequence embedding with multi-scale feature extraction of ligands, and utilizes multi-scale self-attentive wavelet neural networks and convolutional networks to effectively capture key features of ligands. Through the bimodal network structure, the protein sequence information (generated by ESM2 model) is effectively fused with the 2D image or structure mapping data of the drug to enhance the accuracy and interpretability of PLA prediction. Experiments show that MawPLA outperforms existing methods on multiple datasets and facilitates protein-ligand binding affinity studies.


## System Requirements
The source code developed in Python 3.9 using PyTorch 2.1.0+cu118. The required python dependencies are given below.  There is no additional non-standard hardware requirements.
'''
python
dgl
numpy
scikit-learn
rdkit
openbabel==3.1.1
torch==2.1.0+cu118 
torch-geometric==2.6.1 
torch-scatter==2.1.2+pt21cu118
torch-sparse==0.6.18+pt21cu118 
torch-spline-conv ==1.2.2+pt21cu118
torchaudio==2.1.0+cu118
'''


##Datasets
The `data` folder contains all experimental data used in MawPLA: 
#Source data processing
To get the .csv file for training and testing, you can use the code generated in the ". /preprocess/pre-code" file.
#Data pre-processing
The data preprocessing method in this paper is borrowed from the paper: Physicochemical graph neural network for learning protein-ligand interaction fingerprints from sequence data. Nat Mach Intell , vol. 2024.
The protein and ligand preprocessing files "ligand.pt, protein.pt" can be obtained from the ligand.py and protein.py in the ". /preprocess" file.


## Running MawPLA on our data to reproduce the results

#Run the training process of MawPLA on our data.
'''
$ python main.py
'''

#Run MawPLA's testing process on our data.
'''
$ python test.py
'''
